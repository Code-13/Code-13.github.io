<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>Spring-framework源码分析（四）BeanDefinition - 代号十三</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="code-13,代号十三">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/avatar.jpg" type="image/x-icon" />
    <meta name="description" content="BeanDefinition 是 Spring-framework 的基石">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring-framework源码分析（四）BeanDefinition">
<meta property="og:url" content="https://code-13.github.io/blogs/1555ca6d.html">
<meta property="og:site_name" content="代号十三">
<meta property="og:description" content="BeanDefinition 是 Spring-framework 的基石">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730104359.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730110308.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730110500.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730110800.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730112853.png">
<meta property="article:published_time" content="2020-07-27T00:45:24.000Z">
<meta property="article:modified_time" content="2021-12-24T09:12:03.509Z">
<meta property="article:author" content="代号十三">
<meta property="article:tag" content="源码分析">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="Spring-framework">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730104359.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/highlight.js@9.15.8/styles/atom-one-dark.css,npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css,gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css,npm/hexo-theme-nexmoe@latest/source/lib/mdui_043tiny/css/mdui.css,npm/hexo-theme-nexmoe@latest/source/lib/iconfont/iconfont.css?v=233" crossorigin>
    <link rel="stylesheet" href="/css/style.css?v=1640337217067">
     
    
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1640337217067">
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/20200708225124.png)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="代号十三" class="mdui-btn mdui-btn-icon"><img src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/avatar.jpg" alt="代号十三"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="代号十三">
            <img src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/avatar.jpg" alt="代号十三" alt="代号十三">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>12</div>
        <div><span>标签</span>5</div>
        <div><span>分类</span>3</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="https://code-13.github.io/books" title="书海遨游">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                书海遨游
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:code-13.github.io" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://space.bilibili.com/1504682" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/code-13/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/JVM-内存分析/">JVM 内存分析</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/MapStruct/">MapStruct</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Spring-framework源码分析/">Spring-framework源码分析</a>
          <span class="category-list-count">9</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/MAT/" style="font-size: 10px;">MAT</a> <a href="/tags/Spring/" style="font-size: 20px;">Spring</a> <a href="/tags/Spring-framework/" style="font-size: 20px;">Spring-framework</a> <a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 20px;">源码分析</a>
    </div>
    
  </div>

    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2021 代号十三
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br> 有点累
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 62.5%;"> 
              <img data-src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/20/20200720195606.jpg" data-sizes="auto" alt="Spring-framework源码分析（四）BeanDefinition" class="lazyload">
              <h1>Spring-framework源码分析（四）BeanDefinition</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2020年07月27日</a>
    <a><i class="nexmoefont icon-areachart"></i>4.9k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 27 分钟</a>
</div>

      

      <blockquote>
<p>BeanDefinition 是 Spring-framework 的基石</p>
</blockquote>
<span id="more"></span>

<h2 id="什么是BeanDefinition"><a href="#什么是BeanDefinition" class="headerlink" title="什么是BeanDefinition"></a>什么是BeanDefinition</h2><p><code>BeanDefinition</code> 就是 <code>spring bean</code> 的建模对象，就是把一个bean实例化出来的模型对象</p>
<h2 id="为什么需要BeanDefinition"><a href="#为什么需要BeanDefinition" class="headerlink" title="为什么需要BeanDefinition"></a>为什么需要BeanDefinition</h2><p>把一个 <code>bean</code> 实例化出来有 <code>Class</code> 就行了，为什么还需要 <code>BeanDefinition</code> 呢 ？</p>
<p>因为 <code>Class</code> 无法完成 <code>bean</code> 的抽象，比如</p>
<ul>
<li>bean 的作用域</li>
<li>bean 的注入模型</li>
<li>bean 是否是懒加载</li>
<li>等等</li>
</ul>
<p>上述的这些信息 <code>Class</code> 是无法抽象出来的，这就是 <code>BeanDefinition</code> 的作用</p>
<p>相关接口的介绍</p>
<h2 id="BeanMetadataElement源数据接口"><a href="#BeanMetadataElement源数据接口" class="headerlink" title="BeanMetadataElement源数据接口"></a>BeanMetadataElement源数据接口</h2><p>首先我们要能获得源数据，也就是这个bean是来自哪个对象的，我们就可以获得一些相关的信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BeanMetadataElement</span> </span>&#123;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 首先我们要能获得源数据，也就是这个bean是来自哪个对象的，我们就可以获得一些相关的信息。</span><br><span class="hljs-comment">	 */</span><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the configuration source &#123;<span class="hljs-doctag">@code</span> Object&#125; for this metadata element</span><br><span class="hljs-comment">	 * (may be &#123;<span class="hljs-doctag">@code</span> null&#125;).</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">default</span> Object <span class="hljs-title">getSource</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="BeanMetadataAttribute-元数据属性"><a href="#BeanMetadataAttribute-元数据属性" class="headerlink" title="BeanMetadataAttribute 元数据属性"></a>BeanMetadataAttribute 元数据属性</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BeanMetadataAttribute</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BeanMetadataElement</span> </span>&#123;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 属性名字</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 属性值</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Object value;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * bean的来源</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> Object source;<br><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Create a new AttributeValue instance.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> name the name of the attribute (never &#123;<span class="hljs-doctag">@code</span> null&#125;)</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> value the value of the attribute (possibly before type conversion)</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">BeanMetadataAttribute</span><span class="hljs-params">(String name, <span class="hljs-meta">@Nullable</span> Object value)</span> </span>&#123;<br>		<span class="hljs-comment">//将名字和值封装起来</span><br>		Assert.notNull(name, <span class="hljs-string">&quot;Name must not be null&quot;</span>);<br>		<span class="hljs-keyword">this</span>.name = name;<br>		<span class="hljs-keyword">this</span>.value = value;<br>	&#125;<br><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the name of the attribute.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the value of the attribute.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the configuration source &#123;<span class="hljs-doctag">@code</span> Object&#125; for this metadata element.</span><br><span class="hljs-comment">	 * &lt;p&gt;The exact type of the object will depend on the configuration mechanism used.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSource</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object source)</span> </span>&#123;<br>		<span class="hljs-keyword">this</span>.source = source;<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getSource</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.source;<br>	&#125;<br><br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object other)</span> </span>&#123;<br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == other) &#123;<br>			<span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>		&#125;<br>		<span class="hljs-keyword">if</span> (!(other <span class="hljs-keyword">instanceof</span> BeanMetadataAttribute)) &#123;<br>			<span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>		&#125;<br>		BeanMetadataAttribute otherMa = (BeanMetadataAttribute) other;<br>		<span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.name.equals(otherMa.name) &amp;&amp;<br>				ObjectUtils.nullSafeEquals(<span class="hljs-keyword">this</span>.value, otherMa.value) &amp;&amp;<br>				ObjectUtils.nullSafeEquals(<span class="hljs-keyword">this</span>.source, otherMa.source));<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name.hashCode() * <span class="hljs-number">29</span> + ObjectUtils.nullSafeHashCode(<span class="hljs-keyword">this</span>.value);<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;metadata attribute &#x27;&quot;</span> + <span class="hljs-keyword">this</span>.name + <span class="hljs-string">&quot;&#x27;&quot;</span>;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="AttributeAccessor属性访问器"><a href="#AttributeAccessor属性访问器" class="headerlink" title="AttributeAccessor属性访问器"></a>AttributeAccessor属性访问器</h2><p>这个就是定义了属性的操作接口，增删改查，获取所有的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AttributeAccessor</span> </span>&#123;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the attribute defined by &#123;<span class="hljs-doctag">@code</span> name&#125; to the supplied &#123;<span class="hljs-doctag">@code</span> value&#125;.</span><br><span class="hljs-comment">	 * If &#123;<span class="hljs-doctag">@code</span> value&#125; is &#123;<span class="hljs-doctag">@code</span> null&#125;, the attribute is &#123;<span class="hljs-doctag">@link</span> #removeAttribute removed&#125;.</span><br><span class="hljs-comment">	 * &lt;p&gt;In general, users should take care to prevent overlaps with other</span><br><span class="hljs-comment">	 * metadata attributes by using fully-qualified names, perhaps using</span><br><span class="hljs-comment">	 * class or package names as prefix.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> name the unique attribute key</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> value the attribute value to be attached</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setAttribute</span><span class="hljs-params">(String name, <span class="hljs-meta">@Nullable</span> Object value)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Get the value of the attribute identified by &#123;<span class="hljs-doctag">@code</span> name&#125;.</span><br><span class="hljs-comment">	 * Return &#123;<span class="hljs-doctag">@code</span> null&#125; if the attribute doesn&#x27;t exist.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> name the unique attribute key</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the current value of the attribute, if any</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">Object <span class="hljs-title">getAttribute</span><span class="hljs-params">(String name)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Remove the attribute identified by &#123;<span class="hljs-doctag">@code</span> name&#125; and return its value.</span><br><span class="hljs-comment">	 * Return &#123;<span class="hljs-doctag">@code</span> null&#125; if no attribute under &#123;<span class="hljs-doctag">@code</span> name&#125; is found.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> name the unique attribute key</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the last value of the attribute, if any</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">Object <span class="hljs-title">removeAttribute</span><span class="hljs-params">(String name)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return &#123;<span class="hljs-doctag">@code</span> true&#125; if the attribute identified by &#123;<span class="hljs-doctag">@code</span> name&#125; exists.</span><br><span class="hljs-comment">	 * Otherwise return &#123;<span class="hljs-doctag">@code</span> false&#125;.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> name the unique attribute key</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">hasAttribute</span><span class="hljs-params">(String name)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the names of all attributes.</span><br><span class="hljs-comment">	 */</span><br>	String[] attributeNames();<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="AttributeAccessorSupport-属性访问抽象实现类"><a href="#AttributeAccessorSupport-属性访问抽象实现类" class="headerlink" title="AttributeAccessorSupport 属性访问抽象实现类"></a>AttributeAccessorSupport 属性访问抽象实现类</h3><p>这个是对AttributeAccessor接口的抽象实现，定义了一个map来存放名字和属性的映射关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AttributeAccessorSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AttributeAccessor</span>, <span class="hljs-title">Serializable</span> </span>&#123;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 名字与属性相对应</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/** Map with String keys and Object values. */</span><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Object&gt; attributes = <span class="hljs-keyword">new</span> LinkedHashMap&lt;&gt;();<br><br>	<span class="hljs-comment">//设为 null 值就是删除</span><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAttribute</span><span class="hljs-params">(String name, <span class="hljs-meta">@Nullable</span> Object value)</span> </span>&#123;<br>		Assert.notNull(name, <span class="hljs-string">&quot;Name must not be null&quot;</span>);<br>		<span class="hljs-keyword">if</span> (value != <span class="hljs-keyword">null</span>) &#123;<br>			<span class="hljs-keyword">this</span>.attributes.put(name, value);<br>		&#125;<br>		<span class="hljs-keyword">else</span> &#123;<br>			removeAttribute(name);<br>		&#125;<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getAttribute</span><span class="hljs-params">(String name)</span> </span>&#123;<br>		Assert.notNull(name, <span class="hljs-string">&quot;Name must not be null&quot;</span>);<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.attributes.get(name);<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">removeAttribute</span><span class="hljs-params">(String name)</span> </span>&#123;<br>		Assert.notNull(name, <span class="hljs-string">&quot;Name must not be null&quot;</span>);<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.attributes.remove(name);<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasAttribute</span><span class="hljs-params">(String name)</span> </span>&#123;<br>		Assert.notNull(name, <span class="hljs-string">&quot;Name must not be null&quot;</span>);<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.attributes.containsKey(name);<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-keyword">public</span> String[] attributeNames() &#123;<br>		<span class="hljs-keyword">return</span> StringUtils.toStringArray(<span class="hljs-keyword">this</span>.attributes.keySet());<br>	&#125;<br><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Copy the attributes from the supplied AttributeAccessor to this accessor.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> source the AttributeAccessor to copy from</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">copyAttributesFrom</span><span class="hljs-params">(AttributeAccessor source)</span> </span>&#123;<br>		Assert.notNull(source, <span class="hljs-string">&quot;Source must not be null&quot;</span>);<br>		String[] attributeNames = source.attributeNames();<br>		<span class="hljs-keyword">for</span> (String attributeName : attributeNames) &#123;<br>			setAttribute(attributeName, source.getAttribute(attributeName));<br>		&#125;<br>	&#125;<br><br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object other)</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span> == other || (other <span class="hljs-keyword">instanceof</span> AttributeAccessorSupport &amp;&amp;<br>				<span class="hljs-keyword">this</span>.attributes.equals(((AttributeAccessorSupport) other).attributes)));<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.attributes.hashCode();<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="BeanMetadataAttributeAccessor-元数据属性访问器"><a href="#BeanMetadataAttributeAccessor-元数据属性访问器" class="headerlink" title="BeanMetadataAttributeAccessor 元数据属性访问器"></a><code>BeanMetadataAttributeAccessor</code> 元数据属性访问器</h2><p><code>BeanMetadataAttributeAccessor</code> 继承 <code>AttributeAccessorSupport</code> 实现 <code>BeanMetadataElement</code> ，既能获取源数据，也能提供属性访问：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BeanMetadataAttributeAccessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AttributeAccessorSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BeanMetadataElement</span> </span>&#123;<br><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> Object source;<br><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the configuration source &#123;<span class="hljs-doctag">@code</span> Object&#125; for this metadata element.</span><br><span class="hljs-comment">	 * &lt;p&gt;The exact type of the object will depend on the configuration mechanism used.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSource</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Object source)</span> </span>&#123;<br>		<span class="hljs-keyword">this</span>.source = source;<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getSource</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.source;<br>	&#125;<br><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Add the given BeanMetadataAttribute to this accessor&#x27;s set of attributes.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> attribute the BeanMetadataAttribute object to register</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addMetadataAttribute</span><span class="hljs-params">(BeanMetadataAttribute attribute)</span> </span>&#123;<br>		<span class="hljs-keyword">super</span>.setAttribute(attribute.getName(), attribute);<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Look up the given BeanMetadataAttribute in this accessor&#x27;s set of attributes.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> name the name of the attribute</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the corresponding BeanMetadataAttribute object,</span><br><span class="hljs-comment">	 * or &#123;<span class="hljs-doctag">@code</span> null&#125; if no such attribute defined</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> BeanMetadataAttribute <span class="hljs-title">getMetadataAttribute</span><span class="hljs-params">(String name)</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> (BeanMetadataAttribute) <span class="hljs-keyword">super</span>.getAttribute(name);<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAttribute</span><span class="hljs-params">(String name, <span class="hljs-meta">@Nullable</span> Object value)</span> </span>&#123;<br>		<span class="hljs-keyword">super</span>.setAttribute(name, <span class="hljs-keyword">new</span> BeanMetadataAttribute(name, value));<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getAttribute</span><span class="hljs-params">(String name)</span> </span>&#123;<br>		BeanMetadataAttribute attribute = (BeanMetadataAttribute) <span class="hljs-keyword">super</span>.getAttribute(name);<br>		<span class="hljs-keyword">return</span> (attribute != <span class="hljs-keyword">null</span> ? attribute.getValue() : <span class="hljs-keyword">null</span>);<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">removeAttribute</span><span class="hljs-params">(String name)</span> </span>&#123;<br>		BeanMetadataAttribute attribute = (BeanMetadataAttribute) <span class="hljs-keyword">super</span>.removeAttribute(name);<br>		<span class="hljs-keyword">return</span> (attribute != <span class="hljs-keyword">null</span> ? attribute.getValue() : <span class="hljs-keyword">null</span>);<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="BeanDefinition"><a href="#BeanDefinition" class="headerlink" title="BeanDefinition"></a>BeanDefinition</h2><p>BeanDefinition 接口继承 AttributeAccessor 和 BeanMetadataElement</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BeanDefinition</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AttributeAccessor</span>, <span class="hljs-title">BeanMetadataElement</span> </span>&#123;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Scope identifier for the standard singleton scope: &#123;<span class="hljs-doctag">@value</span>&#125;.</span><br><span class="hljs-comment">	 * &lt;p&gt;Note that extended bean factories might support further scopes.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setScope</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> ConfigurableBeanFactory#SCOPE_SINGLETON</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 单例</span><br><span class="hljs-comment">	 */</span><br>	String SCOPE_SINGLETON = ConfigurableBeanFactory.SCOPE_SINGLETON;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Scope identifier for the standard prototype scope: &#123;<span class="hljs-doctag">@value</span>&#125;.</span><br><span class="hljs-comment">	 * &lt;p&gt;Note that extended bean factories might support further scopes.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setScope</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> ConfigurableBeanFactory#SCOPE_PROTOTYPE</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 原型</span><br><span class="hljs-comment">	 */</span><br>	String SCOPE_PROTOTYPE = ConfigurableBeanFactory.SCOPE_PROTOTYPE;<br><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Role hint indicating that a &#123;<span class="hljs-doctag">@code</span> BeanDefinition&#125; is a major part</span><br><span class="hljs-comment">	 * of the application. Typically corresponds to a user-defined bean.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 角色</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-keyword">int</span> ROLE_APPLICATION = <span class="hljs-number">0</span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Role hint indicating that a &#123;<span class="hljs-doctag">@code</span> BeanDefinition&#125; is a supporting</span><br><span class="hljs-comment">	 * part of some larger configuration, typically an outer</span><br><span class="hljs-comment">	 * &#123;<span class="hljs-doctag">@link</span> org.springframework.beans.factory.parsing.ComponentDefinition&#125;.</span><br><span class="hljs-comment">	 * &#123;<span class="hljs-doctag">@code</span> SUPPORT&#125; beans are considered important enough to be aware</span><br><span class="hljs-comment">	 * of when looking more closely at a particular</span><br><span class="hljs-comment">	 * &#123;<span class="hljs-doctag">@link</span> org.springframework.beans.factory.parsing.ComponentDefinition&#125;,</span><br><span class="hljs-comment">	 * but not when looking at the overall configuration of an application.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-keyword">int</span> ROLE_SUPPORT = <span class="hljs-number">1</span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Role hint indicating that a &#123;<span class="hljs-doctag">@code</span> BeanDefinition&#125; is providing an</span><br><span class="hljs-comment">	 * entirely background role and has no relevance to the end-user. This hint is</span><br><span class="hljs-comment">	 * used when registering beans that are completely part of the internal workings</span><br><span class="hljs-comment">	 * of a &#123;<span class="hljs-doctag">@link</span> org.springframework.beans.factory.parsing.ComponentDefinition&#125;.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-keyword">int</span> ROLE_INFRASTRUCTURE = <span class="hljs-number">2</span>;<br><br><br>	<span class="hljs-comment">// Modifiable attributes</span><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the name of the parent definition of this bean definition, if any.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setParentName</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String parentName)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the name of the parent definition of this bean definition, if any.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getParentName</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Specify the bean class name of this bean definition.</span><br><span class="hljs-comment">	 * &lt;p&gt;The class name can be modified during bean factory post-processing,</span><br><span class="hljs-comment">	 * typically replacing the original class name with a parsed variant of it.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setParentName</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setFactoryBeanName</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setFactoryMethodName</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置bean类名字,这个可能会在后置处理器中修改，比如用了 GCLIB 代理配置类的时候就会改</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setBeanClassName</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String beanClassName)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the current bean class name of this bean definition.</span><br><span class="hljs-comment">	 * &lt;p&gt;Note that this does not have to be the actual class name used at runtime, in</span><br><span class="hljs-comment">	 * case of a child definition overriding/inheriting the class name from its parent.</span><br><span class="hljs-comment">	 * Also, this may just be the class that a factory method is called on, or it may</span><br><span class="hljs-comment">	 * even be empty in case of a factory bean reference that a method is called on.</span><br><span class="hljs-comment">	 * Hence, do &lt;i&gt;not&lt;/i&gt; consider this to be the definitive bean type at runtime but</span><br><span class="hljs-comment">	 * rather only use it for parsing purposes at the individual bean definition level.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #getParentName()</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #getFactoryBeanName()</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #getFactoryMethodName()</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getBeanClassName</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Override the target scope of this bean, specifying a new scope name.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #SCOPE_SINGLETON</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #SCOPE_PROTOTYPE</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置范围，是单例，还是原型</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setScope</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String scope)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the name of the current target scope for this bean,</span><br><span class="hljs-comment">	 * or &#123;<span class="hljs-doctag">@code</span> null&#125; if not known yet.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getScope</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set whether this bean should be lazily initialized.</span><br><span class="hljs-comment">	 * &lt;p&gt;If &#123;<span class="hljs-doctag">@code</span> false&#125;, the bean will get instantiated on startup by bean</span><br><span class="hljs-comment">	 * factories that perform eager initialization of singletons.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置是否是懒加载</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setLazyInit</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> lazyInit)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return whether this bean should be lazily initialized, i.e. not</span><br><span class="hljs-comment">	 * eagerly instantiated on startup. Only applicable to a singleton bean.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isLazyInit</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the names of the beans that this bean depends on being initialized.</span><br><span class="hljs-comment">	 * The bean factory will guarantee that these beans get initialized first.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置需要先加载的依赖的类名字数组</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setDependsOn</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String... dependsOn)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the bean names that this bean depends on.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	String[] getDependsOn();<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set whether this bean is a candidate for getting autowired into some other bean.</span><br><span class="hljs-comment">	 * &lt;p&gt;Note that this flag is designed to only affect type-based autowiring.</span><br><span class="hljs-comment">	 * It does not affect explicit references by name, which will get resolved even</span><br><span class="hljs-comment">	 * if the specified bean is not marked as an autowire candidate. As a consequence,</span><br><span class="hljs-comment">	 * autowiring by name will nevertheless inject a bean if the name matches.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置是否适合给其他类做自动装配</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setAutowireCandidate</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> autowireCandidate)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return whether this bean is a candidate for getting autowired into some other bean.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isAutowireCandidate</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set whether this bean is a primary autowire candidate.</span><br><span class="hljs-comment">	 * &lt;p&gt;If this value is &#123;<span class="hljs-doctag">@code</span> true&#125; for exactly one bean among multiple</span><br><span class="hljs-comment">	 * matching candidates, it will serve as a tie-breaker.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setPrimary</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> primary)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return whether this bean is a primary autowire candidate.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置是否优先自动装配</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isPrimary</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Specify the factory bean to use, if any.</span><br><span class="hljs-comment">	 * This the name of the bean to call the specified factory method on.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setFactoryMethodName</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置FactoryBean的名字</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setFactoryBeanName</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String factoryBeanName)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the factory bean name, if any.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getFactoryBeanName</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Specify a factory method, if any. This method will be invoked with</span><br><span class="hljs-comment">	 * constructor arguments, or with no arguments if none are specified.</span><br><span class="hljs-comment">	 * The method will be invoked on the specified factory bean, if any,</span><br><span class="hljs-comment">	 * or otherwise as a static method on the local bean class.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setFactoryBeanName</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #setBeanClassName</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setFactoryMethodName</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String factoryMethodName)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return a factory method, if any.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getFactoryMethodName</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the constructor argument values for this bean.</span><br><span class="hljs-comment">	 * &lt;p&gt;The returned instance can be modified during bean factory post-processing.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the ConstructorArgumentValues object (never &#123;<span class="hljs-doctag">@code</span> null&#125;)</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 获取构造函数的参数</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function">ConstructorArgumentValues <span class="hljs-title">getConstructorArgumentValues</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return if there are constructor argument values defined for this bean.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.0.2</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">default</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasConstructorArgumentValues</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> !getConstructorArgumentValues().isEmpty();<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the property values to be applied to a new instance of the bean.</span><br><span class="hljs-comment">	 * &lt;p&gt;The returned instance can be modified during bean factory post-processing.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the MutablePropertyValues object (never &#123;<span class="hljs-doctag">@code</span> null&#125;)</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function">MutablePropertyValues <span class="hljs-title">getPropertyValues</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return if there are property values defined for this bean.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.0.2</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">default</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasPropertyValues</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> !getPropertyValues().isEmpty();<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the name of the initializer method.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置初始化方法 对应<span class="hljs-doctag">@PostConstruct</span></span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setInitMethodName</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String initMethodName)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the name of the initializer method.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getInitMethodName</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the name of the destroy method.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 设置销毁时候的方法 对应<span class="hljs-doctag">@PreDestroy</span></span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setDestroyMethodName</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String destroyMethodName)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the name of the destroy method.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getDestroyMethodName</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set the role hint for this &#123;<span class="hljs-doctag">@code</span> BeanDefinition&#125;. The role hint</span><br><span class="hljs-comment">	 * provides the frameworks as well as tools an indication of</span><br><span class="hljs-comment">	 * the role and importance of a particular &#123;<span class="hljs-doctag">@code</span> BeanDefinition&#125;.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.1</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #ROLE_APPLICATION</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #ROLE_SUPPORT</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #ROLE_INFRASTRUCTURE</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setRole</span><span class="hljs-params">(<span class="hljs-keyword">int</span> role)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Get the role hint for this &#123;<span class="hljs-doctag">@code</span> BeanDefinition&#125;. The role hint</span><br><span class="hljs-comment">	 * provides the frameworks as well as tools an indication of</span><br><span class="hljs-comment">	 * the role and importance of a particular &#123;<span class="hljs-doctag">@code</span> BeanDefinition&#125;.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #ROLE_APPLICATION</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #ROLE_SUPPORT</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #ROLE_INFRASTRUCTURE</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getRole</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Set a human-readable description of this bean definition.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setDescription</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String description)</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return a human-readable description of this bean definition.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getDescription</span><span class="hljs-params">()</span></span>;<br><br><br>	<span class="hljs-comment">// Read-only attributes</span><br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return a resolvable type for this bean definition,</span><br><span class="hljs-comment">	 * based on the bean class or other specific metadata.</span><br><span class="hljs-comment">	 * &lt;p&gt;This is typically fully resolved on a runtime-merged bean definition</span><br><span class="hljs-comment">	 * but not necessarily on a configuration-time definition instance.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the resolvable type (potentially &#123;<span class="hljs-doctag">@link</span> ResolvableType#NONE&#125;)</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 5.2</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> ConfigurableBeanFactory#getMergedBeanDefinition</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function">ResolvableType <span class="hljs-title">getResolvableType</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return whether this a &lt;b&gt;Singleton&lt;/b&gt;, with a single, shared instance</span><br><span class="hljs-comment">	 * returned on all calls.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #SCOPE_SINGLETON</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isSingleton</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return whether this a &lt;b&gt;Prototype&lt;/b&gt;, with an independent instance</span><br><span class="hljs-comment">	 * returned for each call.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 3.0</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@see</span> #SCOPE_PROTOTYPE</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isPrototype</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return whether this bean is &quot;abstract&quot;, that is, not meant to be instantiated.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isAbstract</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return a description of the resource that this bean definition</span><br><span class="hljs-comment">	 * came from (for the purpose of showing context in case of errors).</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">String <span class="hljs-title">getResourceDescription</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Return the originating BeanDefinition, or &#123;<span class="hljs-doctag">@code</span> null&#125; if none.</span><br><span class="hljs-comment">	 * &lt;p&gt;Allows for retrieving the decorated bean definition, if any.</span><br><span class="hljs-comment">	 * &lt;p&gt;Note that this method returns the immediate originator. Iterate through the</span><br><span class="hljs-comment">	 * originator chain to find the original BeanDefinition as defined by the user.</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">BeanDefinition <span class="hljs-title">getOriginatingBeanDefinition</span><span class="hljs-params">()</span></span>;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="AbstractBeanDefinition"><a href="#AbstractBeanDefinition" class="headerlink" title="AbstractBeanDefinition"></a>AbstractBeanDefinition</h2><p><img src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730104359.png"></p>
<p>其实就是继承了上面的bean元数据访问器并且实现了bean定义接口，这样的话就可以让bean的元数据和bean的定义接口联系起来了，也就是数据和操作结合了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//this.beanClasss是对象，可以是String也可以是Class</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getBeanClassName</span><span class="hljs-params">()</span> </span>&#123;<br>	Object beanClassObject = <span class="hljs-keyword">this</span>.beanClass;<br>	<span class="hljs-keyword">if</span> (beanClassObject <span class="hljs-keyword">instanceof</span> Class) &#123;<br>		<span class="hljs-keyword">return</span> ((Class&lt;?&gt;) beanClassObject).getName();<br>	&#125;<br>	<span class="hljs-keyword">else</span> &#123;<br>		<span class="hljs-keyword">return</span> (String) beanClassObject;<br>	&#125;<br>&#125;<br><br><span class="hljs-comment">//可以传Class</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBeanClass</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Class&lt;?&gt; beanClass)</span> </span>&#123;<br>	<span class="hljs-keyword">this</span>.beanClass = beanClass;<br>&#125;<br><span class="hljs-comment">//判断beanClass是否是个Class对象</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasBeanClass</span><span class="hljs-params">()</span> </span>&#123;<br>	<span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.beanClass <span class="hljs-keyword">instanceof</span> Class);<br>&#125;<br><br><span class="hljs-comment">//定义了一个克隆的抽象方法</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> AbstractBeanDefinition <span class="hljs-title">cloneBeanDefinition</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure>

<h2 id="GenericBeanDefinition"><a href="#GenericBeanDefinition" class="headerlink" title="GenericBeanDefinition"></a>GenericBeanDefinition</h2><p><img src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730110308.png"></p>
<p>继承 AbstractBeanDefinition 主要是实现了克隆的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> AbstractBeanDefinition <span class="hljs-title">cloneBeanDefinition</span><span class="hljs-params">()</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GenericBeanDefinition(<span class="hljs-keyword">this</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="AnnotatedBeanDefinition"><a href="#AnnotatedBeanDefinition" class="headerlink" title="AnnotatedBeanDefinition"></a>AnnotatedBeanDefinition</h2><p><img src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730110500.png"></p>
<p>加了两个新方法，其实就是注解的元数据和工厂方法的元数据，这些数据在进行解析处理的时候需要用到。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AnnotatedBeanDefinition</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BeanDefinition</span> </span>&#123;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Obtain the annotation metadata (as well as basic class metadata)</span><br><span class="hljs-comment">	 * for this bean definition&#x27;s bean class.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the annotation metadata object (never &#123;<span class="hljs-doctag">@code</span> null&#125;)</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function">AnnotationMetadata <span class="hljs-title">getMetadata</span><span class="hljs-params">()</span></span>;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Obtain metadata for this bean definition&#x27;s factory method, if any.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@return</span> the factory method metadata, or &#123;<span class="hljs-doctag">@code</span> null&#125; if none</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 4.1.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function">MethodMetadata <span class="hljs-title">getFactoryMethodMetadata</span><span class="hljs-params">()</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="AnnotatedGenericBeanDefinition"><a href="#AnnotatedGenericBeanDefinition" class="headerlink" title="AnnotatedGenericBeanDefinition"></a>AnnotatedGenericBeanDefinition</h2><p><img src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730110800.png"></p>
<p>AnnotatedGenericBeanDefinition将通用bean定义 <code>GenericBeanDefinition</code> 和注解bean定义 <code>AnnotatedBeanDefinition</code> 拼起来了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnnotatedGenericBeanDefinition</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GenericBeanDefinition</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AnnotatedBeanDefinition</span> </span>&#123;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 注解元数据</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AnnotationMetadata metadata;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 工厂方法元数据</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-keyword">private</span> MethodMetadata factoryMethodMetadata;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 通过 beanClass 来获取元数据</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Create a new AnnotatedGenericBeanDefinition for the given bean class.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> beanClass the loaded bean class</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AnnotatedGenericBeanDefinition</span><span class="hljs-params">(Class&lt;?&gt; beanClass)</span> </span>&#123;<br>		setBeanClass(beanClass);<br>		<span class="hljs-keyword">this</span>.metadata = AnnotationMetadata.introspect(beanClass);<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 从注解元数据获取 beanClass</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Create a new AnnotatedGenericBeanDefinition for the given annotation metadata,</span><br><span class="hljs-comment">	 * allowing for ASM-based processing and avoidance of early loading of the bean class.</span><br><span class="hljs-comment">	 * Note that this constructor is functionally equivalent to</span><br><span class="hljs-comment">	 * &#123;<span class="hljs-doctag">@link</span> org.springframework.context.annotation.ScannedGenericBeanDefinition</span><br><span class="hljs-comment">	 * ScannedGenericBeanDefinition&#125;, however the semantics of the latter indicate that a</span><br><span class="hljs-comment">	 * bean was discovered specifically via component-scanning as opposed to other means.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> metadata the annotation metadata for the bean class in question</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 3.1.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AnnotatedGenericBeanDefinition</span><span class="hljs-params">(AnnotationMetadata metadata)</span> </span>&#123;<br>		Assert.notNull(metadata, <span class="hljs-string">&quot;AnnotationMetadata must not be null&quot;</span>);<br>		<span class="hljs-keyword">if</span> (metadata <span class="hljs-keyword">instanceof</span> StandardAnnotationMetadata) &#123;<br>			setBeanClass(((StandardAnnotationMetadata) metadata).getIntrospectedClass());<br>		&#125;<br>		<span class="hljs-keyword">else</span> &#123;<br>			setBeanClassName(metadata.getClassName());<br>		&#125;<br>		<span class="hljs-keyword">this</span>.metadata = metadata;<br>	&#125;<br><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * 从注解元数据与方法元数据创建</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-comment">/**</span><br><span class="hljs-comment">	 * Create a new AnnotatedGenericBeanDefinition for the given annotation metadata,</span><br><span class="hljs-comment">	 * based on an annotated class and a factory method on that class.</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> metadata the annotation metadata for the bean class in question</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> factoryMethodMetadata metadata for the selected factory method</span><br><span class="hljs-comment">	 * <span class="hljs-doctag">@since</span> 4.1.1</span><br><span class="hljs-comment">	 */</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AnnotatedGenericBeanDefinition</span><span class="hljs-params">(AnnotationMetadata metadata, MethodMetadata factoryMethodMetadata)</span> </span>&#123;<br>		<span class="hljs-keyword">this</span>(metadata);<br>		Assert.notNull(factoryMethodMetadata, <span class="hljs-string">&quot;MethodMetadata must not be null&quot;</span>);<br>		setFactoryMethodName(factoryMethodMetadata.getMethodName());<br>		<span class="hljs-keyword">this</span>.factoryMethodMetadata = factoryMethodMetadata;<br>	&#125;<br><br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> AnnotationMetadata <span class="hljs-title">getMetadata</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.metadata;<br>	&#125;<br><br>	<span class="hljs-meta">@Override</span><br>	<span class="hljs-meta">@Nullable</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> MethodMetadata <span class="hljs-title">getFactoryMethodMetadata</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.factoryMethodMetadata;<br>	&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="RootBeanDefinition"><a href="#RootBeanDefinition" class="headerlink" title="RootBeanDefinition"></a>RootBeanDefinition</h2><p><img src="https://cdn.jsdelivr.net/gh/code-13/cloudimage/images/2020/07/30/20200730112853.png"></p>
<p><code>RootBeanDefinition</code> 的主要作用是将其他类型的 BeanDefinition 在运行时合并起来，spring基本内部的定义都是用这个</p>
<p>实现太长，各别解释</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 在读/写和创建实例的方法有关的字段、缓存字段时使用此锁。</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> Object constructorArgumentLock = <span class="hljs-keyword">new</span> Object();<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 在读/写后处理器相关缓存字段时使用此锁</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> Object postProcessingLock = <span class="hljs-keyword">new</span> Object();<br><br><span class="hljs-comment">// 默认允许启用缓存</span><br><span class="hljs-keyword">boolean</span> allowCaching = <span class="hljs-keyword">true</span>;<br><br><span class="hljs-comment">// 你的 FactoryMethod 有没有专门设置值【捷径方法】</span><br><span class="hljs-keyword">boolean</span> isFactoryMethodUnique = <span class="hljs-keyword">false</span>;<br><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-comment">// bean 中包含的范型 ？？？？？？【待定】</span><br><span class="hljs-keyword">volatile</span> ResolvableType targetType;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 缓存之前确定好的 Bean 实例类型</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">volatile</span> Class&lt;?&gt; resolvedTargetType;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 缓存之前确定好的创建实例的方法返回的类型</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">volatile</span> ResolvableType factoryMethodReturnType;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 缓存之前确定好的创建实例的方法【可能是构造方法、可能是工厂方法】</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Nullable</span><br>Executable resolvedConstructorOrFactoryMethod;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 我们有没有缓存创建实例的入参【捷径方法】</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">boolean</span> constructorArgumentsResolved = <span class="hljs-keyword">false</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 缓存之前确定好的创建实例的入参【可能是构造方法、可能是工厂方法】【这个是完整的一套入参】</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Nullable</span><br>Object[] resolvedConstructorArguments;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 缓存之前确定好的创建实例的入参【可能是构造方法、可能是工厂方法】【这个是不完整的一套入参，可能少东西】</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Nullable</span><br>Object[] preparedConstructorArguments;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 标记此 bd 是否被应用过后处理器的钩子【MergedBeanDefinitionPostProcessor】</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">boolean</span> postProcessed = <span class="hljs-keyword">false</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 标记量，表明此 bd 是否要执行创造 bean 前的钩子【用于决定 aop 是否可以织入】</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">volatile</span> Boolean beforeInstantiationResolved;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> **/</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">private</span> BeanDefinitionHolder decoratedDefinition;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> **/</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">private</span> AnnotatedElement qualifiedElement;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> **/</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">private</span> Set&lt;Member&gt; externallyManagedConfigMembers;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> **/</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">private</span> Set&lt;String&gt; externallyManagedInitMethods;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> **/</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-keyword">private</span> Set&lt;String&gt; externallyManagedDestroyMethods;<br></code></pre></td></tr></table></figure>

<h2 id="MergedBeanDefinition"><a href="#MergedBeanDefinition" class="headerlink" title="MergedBeanDefinition"></a>MergedBeanDefinition</h2><p>在Spring中,关于bean定义,其Java建模模型是接口BeanDefinition, 其变种有RootBeanDefinition，ChildBeanDefinition，还有GenericBeanDefinition，AnnotatedGenericBeanDefinition,ScannedGenericBeanDefinition等等。这些概念模型抽象了不同的关注点。关于这些概念模型，除了有概念，也有相应的Java建模模型，甚至还有通用的实现部分AbstractBeanDefinition。但事实上，关于BeanDefinition，还有一个概念也很重要，这就是MergedBeanDefinition(中文也许应该翻译成”合并了的bean定义”?),但这个概念并没有相应的Java模型对应。但是它确实存在，并且Spring专门为它提供了一个生命周期回调定义接口MergedBeanDefinitionPostProcessor用于扩展。</p>
<h3 id="MergedBeanDefinition的生成"><a href="#MergedBeanDefinition的生成" class="headerlink" title="MergedBeanDefinition的生成"></a>MergedBeanDefinition的生成</h3><p>AbstractBeanFactory#getMergedLocalBeanDefinition(String beanName)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> RootBeanDefinition <span class="hljs-title">getMergedLocalBeanDefinition</span><span class="hljs-params">(String beanName)</span> <span class="hljs-keyword">throws</span> BeansException </span>&#123;<br>  <span class="hljs-comment">// Quick check on the concurrent map first, with minimal locking.</span><br>  RootBeanDefinition mbd = <span class="hljs-keyword">this</span>.mergedBeanDefinitions.get(beanName);<br>  <span class="hljs-keyword">if</span> (mbd != <span class="hljs-keyword">null</span> &amp;&amp; !mbd.stale) &#123;<br>    <span class="hljs-keyword">return</span> mbd;<br>  &#125;<br>  <span class="hljs-keyword">return</span> getMergedBeanDefinition(beanName, getBeanDefinition(beanName));<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> RootBeanDefinition <span class="hljs-title">getMergedBeanDefinition</span><span class="hljs-params">(String beanName, BeanDefinition bd)</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> BeanDefinitionStoreException </span>&#123;<br><br>  <span class="hljs-keyword">return</span> getMergedBeanDefinition(beanName, bd, <span class="hljs-keyword">null</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> RootBeanDefinition <span class="hljs-title">getMergedBeanDefinition</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    String beanName, BeanDefinition bd, <span class="hljs-meta">@Nullable</span> BeanDefinition containingBd)</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> BeanDefinitionStoreException </span>&#123;<br><br>  <span class="hljs-keyword">synchronized</span> (<span class="hljs-keyword">this</span>.mergedBeanDefinitions) &#123;<br><br>    <span class="hljs-comment">// 准备一个RootBeanDefinition变量引用，用于记录要构建和最终要返回的BeanDefinition，</span><br>    <span class="hljs-comment">// 这里根据上下文不难猜测 mbd 应该就是 mergedBeanDefinition 的缩写。</span><br>    RootBeanDefinition mbd = <span class="hljs-keyword">null</span>;<br><br><br>    RootBeanDefinition previous = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-comment">// Check with full lock now in order to enforce the same merged instance.</span><br>    <span class="hljs-keyword">if</span> (containingBd == <span class="hljs-keyword">null</span>) &#123;<br>      mbd = <span class="hljs-keyword">this</span>.mergedBeanDefinitions.get(beanName);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (mbd == <span class="hljs-keyword">null</span> || mbd.stale) &#123;<br>      previous = mbd;<br>      <span class="hljs-keyword">if</span> (bd.getParentName() == <span class="hljs-keyword">null</span>) &#123;<br><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">          * bd不是一个ChildBeanDefinition的情况,换句话讲，这 bd应该是 :</span><br><span class="hljs-comment">          * 1. 一个独立的 GenericBeanDefinition 实例，parentName 属性为null</span><br><span class="hljs-comment">          * 2. 或者是一个 RootBeanDefinition 实例，parentName 属性为null</span><br><span class="hljs-comment">          * 此时mbd直接使用一个bd的复制品</span><br><span class="hljs-comment">          */</span><br><br>        <span class="hljs-comment">// Use copy of given root bean definition.</span><br>        <span class="hljs-keyword">if</span> (bd <span class="hljs-keyword">instanceof</span> RootBeanDefinition) &#123;<br>          mbd = ((RootBeanDefinition) bd).cloneBeanDefinition();<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>          mbd = <span class="hljs-keyword">new</span> RootBeanDefinition(bd);<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">else</span> &#123;<br><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">          * bd是一个ChildBeanDefinition的情况,这种情况下，需要将bd和其parent bean definition 合并到一起，形成最终的 mbd</span><br><span class="hljs-comment">          * 面是获取bd的 parent bean definition 的过程，最终结果记录到 pbd，</span><br><span class="hljs-comment">          *</span><br><span class="hljs-comment">          * 并且可以看到该过程中递归使用了getMergedBeanDefinition(), 为什么呢?因为 bd 的 parent bd 可能也是个ChildBeanDefinition，所以该过程需要递归处理</span><br><span class="hljs-comment">          */</span><br><br>        <span class="hljs-comment">// Child bean definition: needs to be merged with parent.</span><br>        BeanDefinition pbd;<br>        <span class="hljs-keyword">try</span> &#123;<br>          String parentBeanName = transformedBeanName(bd.getParentName());<br>          <span class="hljs-keyword">if</span> (!beanName.equals(parentBeanName)) &#123;<br>            pbd = getMergedBeanDefinition(parentBeanName);<br>          &#125;<br>          <span class="hljs-keyword">else</span> &#123;<br>            BeanFactory parent = getParentBeanFactory();<br>            <span class="hljs-keyword">if</span> (parent <span class="hljs-keyword">instanceof</span> ConfigurableBeanFactory) &#123;<br>              pbd = ((ConfigurableBeanFactory) parent).getMergedBeanDefinition(parentBeanName);<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NoSuchBeanDefinitionException(parentBeanName,<br>                  <span class="hljs-string">&quot;Parent name &#x27;&quot;</span> + parentBeanName + <span class="hljs-string">&quot;&#x27; is equal to bean name &#x27;&quot;</span> + beanName +<br>                  <span class="hljs-string">&quot;&#x27;: cannot be resolved without a ConfigurableBeanFactory parent&quot;</span>);<br>            &#125;<br>          &#125;<br>        &#125;<br>        <span class="hljs-keyword">catch</span> (NoSuchBeanDefinitionException ex) &#123;<br>          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BeanDefinitionStoreException(bd.getResourceDescription(), beanName,<br>              <span class="hljs-string">&quot;Could not resolve parent bean definition &#x27;&quot;</span> + bd.getParentName() + <span class="hljs-string">&quot;&#x27;&quot;</span>, ex);<br>        &#125;<br><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">          * 现在已经获取 bd 的 parent bd 到 pbd，这个 pbd 也是已经合并过的</span><br><span class="hljs-comment">          * 这里使用pbd创建最终的mbd，然后再使用bd覆盖一次，这样就相当于mbd来自两个BeanDefinition:当前 BeanDefinition 及其合并的(&quot;Merged&quot;)双亲 BeanDefinition,</span><br><span class="hljs-comment">          * 然后mbd就是针对当前bd的一个MergedBeanDefinition(合并的BeanDefinition)了。</span><br><span class="hljs-comment">          */</span><br><br>        <span class="hljs-comment">// Deep copy with overridden values.</span><br>        mbd = <span class="hljs-keyword">new</span> RootBeanDefinition(pbd);<br>        mbd.overrideFrom(bd);<br>      &#125;<br><br>      <span class="hljs-comment">// Set default singleton scope, if not configured before.</span><br>      <span class="hljs-keyword">if</span> (!StringUtils.hasLength(mbd.getScope())) &#123;<br>        mbd.setScope(SCOPE_SINGLETON);<br>      &#125;<br><br>      <span class="hljs-comment">// A bean contained in a non-singleton bean cannot be a singleton itself.</span><br>      <span class="hljs-comment">// Let&#x27;s correct this on the fly here, since this might be the result of</span><br>      <span class="hljs-comment">// parent-child merging for the outer bean, in which case the original inner bean</span><br>      <span class="hljs-comment">// definition will not have inherited the merged outer bean&#x27;s singleton status.</span><br>      <span class="hljs-keyword">if</span> (containingBd != <span class="hljs-keyword">null</span> &amp;&amp; !containingBd.isSingleton() &amp;&amp; mbd.isSingleton()) &#123;<br>        mbd.setScope(containingBd.getScope());<br>      &#125;<br><br>      <span class="hljs-comment">// Cache the merged bean definition for the time being</span><br>      <span class="hljs-comment">// (it might still get re-merged later on in order to pick up metadata changes)</span><br>      <span class="hljs-keyword">if</span> (containingBd == <span class="hljs-keyword">null</span> &amp;&amp; isCacheBeanMetadata()) &#123;<br>        <span class="hljs-keyword">this</span>.mergedBeanDefinitions.put(beanName, mbd);<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (previous != <span class="hljs-keyword">null</span>) &#123;<br>      copyRelevantMergedBeanDefinitionCaches(previous, mbd);<br>    &#125;<br>    <span class="hljs-keyword">return</span> mbd;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>从上面的 <code>MergedBeanDefinition</code> 的获取过程可以看出，一个 <code>MergedBeanDefinition</code> 其实就是一个”合并了的 <code>BeanDefinition</code> “，最终以 <code>RootBeanDefinition</code> 的类型存在。</p>
<h3 id="MergedBeanDefinition的应用"><a href="#MergedBeanDefinition的应用" class="headerlink" title="MergedBeanDefinition的应用"></a>MergedBeanDefinition的应用</h3><p>下面是类 <code>AbstractAutowireCapableBeanFactory</code> 中bean创建方法createBean()的实现，可以看到，针对传入的参数 RootBeanDefinition mbd,也就是上面生成的 <code>MergedBeanDefinition</code> ,专门有一个 <code>applyMergedBeanDefinitionPostProcessors</code> 调用，这里就是容器中注册的 <code>MergedBeanDefinitionPostProcessor</code> 的应用阶段 ：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">doCreateBean</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String beanName, <span class="hljs-keyword">final</span> RootBeanDefinition mbd, </span></span><br><span class="hljs-params"><span class="hljs-function">	<span class="hljs-keyword">final</span> <span class="hljs-meta">@Nullable</span> Object[] args)</span>	<span class="hljs-keyword">throws</span> BeanCreationException </span>&#123;<br>        <span class="hljs-comment">// ...</span><br><br>    <span class="hljs-comment">// 创建bean POJO 对象</span><br>    instanceWrapper = createBeanInstance(beanName, mbd, args);<br><br>    <span class="hljs-comment">// ...        </span><br>    <br>    <span class="hljs-comment">// 修改 merged bean definition 的 BeanPostProcessor 的执行	</span><br>      <span class="hljs-comment">// ==== 调用 MergedBeanDefinitionPostProcessor ====</span><br>    applyMergedBeanDefinitionPostProcessors(mbd, beanType, beanName); <br>  <br>      <span class="hljs-comment">// ...</span><br><br>    <span class="hljs-comment">// 填充 bean 属性:依赖注入处理，属性设置</span><br>    populateBean(beanName, mbd, instanceWrapper);<br><br>      <span class="hljs-comment">// ...</span><br>    <br>    <span class="hljs-comment">// 初始化 bean : 调用设置的初始化方法，接口定义的初始化方法，</span><br>    <span class="hljs-comment">// 以及相应的 pre-/post-init 生命周期回调函数</span><br>    initializeBean(beanName, exposedObject, mbd);       <br><br>    <span class="hljs-comment">// ...</span><br><br>    <span class="hljs-comment">// 如果当前 bean 实现类有关销毁时的接口或者函数，将它进行相应的登记</span><br>    <span class="hljs-comment">// 供容器关闭时执行相应的回调函数	</span><br>    registerDisposableBeanIfNecessary(beanName, bean, mbd);                   <br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 找到容器中注册的所有BeanPostProcessor中每一个MergedBeanDefinitionPostProcessor，</span><br><span class="hljs-comment">// 将它们应用到指定的RootBeanDefinition mbd上，这里 mbd 其实就是一个 MergedBeanDefinition。</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">applyMergedBeanDefinitionPostProcessors</span><span class="hljs-params">(RootBeanDefinition mbd, </span></span><br><span class="hljs-params"><span class="hljs-function">    Class&lt;?&gt; beanType, String beanName)</span> </span>&#123;<br>  <span class="hljs-keyword">for</span> (BeanPostProcessor bp : getBeanPostProcessors()) &#123;<br>    <span class="hljs-keyword">if</span> (bp <span class="hljs-keyword">instanceof</span> MergedBeanDefinitionPostProcessor) &#123;<br>      MergedBeanDefinitionPostProcessor bdp = (MergedBeanDefinitionPostProcessor) bp;<br>      bdp.postProcessMergedBeanDefinition(mbd, beanType, beanName);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>代号十三<br>
        <strong>本文链接：</strong><a href="https://code-13.github.io/blogs/1555ca6d.html" title="https:&#x2F;&#x2F;code-13.github.io&#x2F;blogs&#x2F;1555ca6d.html" target="_blank" rel="noopener">https:&#x2F;&#x2F;code-13.github.io&#x2F;blogs&#x2F;1555ca6d.html</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/Spring-framework%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">Spring-framework源码分析</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/Spring/" rel="tag">Spring</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/Spring-framework/" rel="tag">Spring-framework</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" rel="tag">源码分析</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: 'f3372034aa4218f9f359',
        clientSecret: '235d14468b5af5837a9ff5e7b7541e93070cf602',
        id: window.location.pathname,
        repo: 'code-13.github.io',
        owner: 'code-13',
        admin: 'code-13'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFBeanDefinition"><span class="toc-number">1.</span> <span class="toc-text">什么是BeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81BeanDefinition"><span class="toc-number">2.</span> <span class="toc-text">为什么需要BeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanMetadataElement%E6%BA%90%E6%95%B0%E6%8D%AE%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.</span> <span class="toc-text">BeanMetadataElement源数据接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BeanMetadataAttribute-%E5%85%83%E6%95%B0%E6%8D%AE%E5%B1%9E%E6%80%A7"><span class="toc-number">3.1.</span> <span class="toc-text">BeanMetadataAttribute 元数据属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AttributeAccessor%E5%B1%9E%E6%80%A7%E8%AE%BF%E9%97%AE%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">AttributeAccessor属性访问器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AttributeAccessorSupport-%E5%B1%9E%E6%80%A7%E8%AE%BF%E9%97%AE%E6%8A%BD%E8%B1%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">4.1.</span> <span class="toc-text">AttributeAccessorSupport 属性访问抽象实现类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanMetadataAttributeAccessor-%E5%85%83%E6%95%B0%E6%8D%AE%E5%B1%9E%E6%80%A7%E8%AE%BF%E9%97%AE%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">BeanMetadataAttributeAccessor 元数据属性访问器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanDefinition"><span class="toc-number">6.</span> <span class="toc-text">BeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AbstractBeanDefinition"><span class="toc-number">7.</span> <span class="toc-text">AbstractBeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GenericBeanDefinition"><span class="toc-number">8.</span> <span class="toc-text">GenericBeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AnnotatedBeanDefinition"><span class="toc-number">9.</span> <span class="toc-text">AnnotatedBeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AnnotatedGenericBeanDefinition"><span class="toc-number">10.</span> <span class="toc-text">AnnotatedGenericBeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RootBeanDefinition"><span class="toc-number">11.</span> <span class="toc-text">RootBeanDefinition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MergedBeanDefinition"><span class="toc-number">12.</span> <span class="toc-text">MergedBeanDefinition</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MergedBeanDefinition%E7%9A%84%E7%94%9F%E6%88%90"><span class="toc-number">12.1.</span> <span class="toc-text">MergedBeanDefinition的生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MergedBeanDefinition%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">12.2.</span> <span class="toc-text">MergedBeanDefinition的应用</span></a></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="搜索" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1640337217079"></script>



<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





</body>

</html>
